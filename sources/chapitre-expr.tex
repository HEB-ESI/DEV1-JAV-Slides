% === Cours de Java
% === Chapitre : Les expressions

%\section{Les expressions}
\subsection{Les expressions}

\imgfullh{../img/expression_by_bogdanboev-d5rs94g.jpg}{
	\Large\bf\color{white}
	Expression
}{http://bogdanboev.deviantart.com/art/Expression-348998704}

\full[bluepigment]{
	\color{azuremist}
	\textbf{Expression}
	\par\medskip
	Calcul faisant intervenir une ou plusieurs valeur(s) pour une opération 
	déterminée. 
	\\Cette valeur peut, elle-même être une expression.
}

\begin{frame}[fragile]{Définitions}
	\emph{Exemple} : \java{1+2}
  	\begin{itemize}
		\item \java{1} et \java{2} sont les \textbf{opérandes}
		\item \java{+} est l'\textbf{opérateur}
  		\item l'expression est de type \java{int}
  		\item la valeur de l'expression est $3$
  	\end{itemize}
\end{frame}


%%%
%\subsection{Les expressions entières}

\begin{frame}[fragile]{Les expressions entières}
	\emph{Opérateurs entiers}
	\begin{center}
		\Large
		\java{+} \java{-}
		\hspace{5mm}
		\java{+} \java{-} \java{*} \java{/} \java{\%}
	\end{center}
	\medskip
	\emph{Opérandes} pouvant intervenir
	\begin{itemize}
		\item un \emph{littéral} 
		\item une \emph{variable}
		\item une \emph{expression}
	\end{itemize}
\end{frame}

\note{
	\par Distinguer les opérateurs binaires et les unaires 
	\par Donner des exemples (beaucoup) d'expressions entières
}


\begin{frame}[fragile]{Les expressions entières}
	Les opérandes doivent être de \emph{même} type (entier)
	\\\textit{à conversion près}
	\begin{itemize}	
		\item Le type de l'expression est celui de ses opérandes
		\item Exemples :
		\begin{itemize}
  			\item \java{1 + 2} vaut $3$ de type \java{int}
  			\item \java{1L + 2L} vaut $3$ de type \java{long}
  			\item \java{3 / 2} vaut $1$ de type \java{int}
  		\end{itemize}
	\end{itemize}
\end{frame}

\full[bluepigment]{
	\color{azuremist}
	\begin{center}
		\huge
		\texttt{i+i*2}
	\end{center}
}

\note{
	\par (i+i)*2 ou i+(i*2) ? 
	\par Notions de priorité des opérateurs
	\par En gros: « comme en math »
}

\begin{frame}[fragile]{Priorité et associativité}
	La stratégie d'évaluation se base sur
  	\begin{itemize}
  		\item la \emph{priorité} d'un opérateur
  		\item l'\emph{associativité} des opérateurs de même priorité
  	\end{itemize} 
\begin{center}
\begin{tabular}{r|c|c}
 priorité & opérateur & associativité \\ \hline
grande & \java{-}, \java{+} unaires & $\Longleftarrow$ \\
 & \java{*}, \java{/}, \java{\%} & $\Longrightarrow$ \\
faible & \java{-}, \java{+} binaires & $\Longrightarrow$ \\
\end{tabular}
\end{center}
\end{frame}

\begin{frame}[fragile]{Priorité et associativité}
	\emph{Exercices}
  	\begin{itemize}
  		\item \java{3 + 3 * 2 + 1} ?
  		\item \java{3 + 3 * 2 / - 4 + 5 \% 8} ?
  	\end{itemize}  
	\bigskip
	\bigskip
	Les \emph{parenthèses} permettent de \textbf{forcer} la stratégie, 
	\textbf{expliciter} l'ordre
	et \textbf{clarifier}.
\end{frame}

\begin{frame}{Erreurs de calcul}
	La \emph{division par zéro} 
	\begin{itemize}
		\item Lance une \textit{exception} (\textit{ArithmeticException})
		\item Pour l'instant, \emph{arrête le programme} avec un message explicite
	\end{itemize} 
	\bigskip
	Le \emph{dépassement de capacité} 
	\begin{itemize}
		\item N'est \emph{pas détecté} par la machine virtuelle
		\item Le résultat est tout simplement faux
	\end{itemize} 
\end{frame}

%%%
%\subsection{Les expressions flottantes}

\begin{frame}[fragile]{Les expressions flottantes}
	\emph{Opérateurs flottants}
	\begin{center}
		\Large
		\java{+} \java{-}
		\hspace{5mm}
		\java{+} \java{-} \java{*} \java{/} 
	\end{center}
	\bigskip
	\emph{Opérandes} (littéral, variable ou expression) du même type 
	\emph{flottant} (\textit{à conversion près})
\end{frame}

\begin{frame}[fragile]{Les expressions flottantes}
	\emph{Exemples} : Donner la valeur et le type de 
	\begin{itemize}
		\item \java{1.0 + 2.3}
		\item \java{1.0d - 2.3d}
		\item \java{7.0f / 3.5f}  
		\item \java{1. / 3.}
	\end{itemize} 
\end{frame}

%%%
%\subsection{Les expressions caractères}

\begin{frame}[fragile]{Les expressions caractères}
	\java{char} est un type numérique entier
	\bigskip
	\begin{itemize}
		\item \emph{aucun opérateur} spécifique 
		\item Calculs possibles mais non recommandé
	  	\\\emph{Exemple} : \java{'a' + 'b'}
	\end{itemize}
\end{frame}

%%%
%\subsection{Les chaines de caractères}

\begin{frame}[fragile]{Les chaines de caractères}
	\emph{Opérateur}
	\begin{center}
		\Huge
		\java{+} 
	\end{center}
	\bigskip
	\begin{itemize}
		\item Un seul opérateur pour la \emph{concaténation} de deux chaines.
		\item Conversion si un des 2 opérandes n'est pas une chaine.
	\end{itemize}
\end{frame}

\note{
	\par Donner des exemples.
	\par Donner des exemples où il y a conversion et où la priorité à 
	de l'importance
}

%%%
%\subsection{Les expressions booléennes}

\begin{frame}[fragile]{Les expressions booléennes}
	\emph{Opérateurs booléens}
	\begin{center}
		\Large
		\Colorbox{listingback}{\verb|!|}  
		\hspace{5mm}
		\java{&&} \java{||}
	\end{center}
	\bigskip
	Tables de vérité
	\begin{center}
	\begin{tabular}{c|c|c|} 
	(ET) & \java{true} & \java{false} \\ \hline
	\java{true} & \java{true} & \java{false} \\ \hline
	\java{false} & \java{false} & \java{false} \\ \hline
	\end{tabular} 
	\hspace{4mm}
	\begin{tabular}{c|c|c|} 
	(OU) & \java{true} & \java{false} \\ \hline
	\java{true} & \java{true} & \java{true} \\ \hline
	\java{false} & \java{true} & \java{false} \\ \hline
	\end{tabular} 
\end{center}
\end{frame}

\note{
	\par Particularité du ET: si l'opérande de gauche est \emph{faux}, 
	l'opérande droit \emph{ne sera pas évalué} et le résultat sera \java{false}
	\par Particularité du OU: si l'opérande de gauche est \emph{vrai}, 
	l'opérande droit \emph{ne sera pas évalué} et le résultat sera \java{true} 
}

\begin{frame}[fragile]{Les expressions booléennes}
	\textbf{Tableau des priorités \#2}
	\begin{center}
	\begin{tabular}{r|c|c}
 	priorité & opérateur & associativité \\ \hline
	grande & \java{-}, \java{+} unaires, \Colorbox{listingback}{\verb|!|} & $\Longleftarrow$ \\
	& \java{*}, \java{/}, \java{\%} & $\Longrightarrow$ \\
 	& \java{-}, \java{+} binaires & $\Longrightarrow$ \\
 	& \java{&&} & $\Longrightarrow$ \\
	faible & \java{||} & $\Longrightarrow$ \\
	\end{tabular}
	\end{center}
\end{frame}


\begin{frame}[fragile]{Exemples}
	Comment évaluer ?
	\begin{itemize}
		\item \java{true && false || true} 
		\item \Colorbox{listingback}{\verb/false || false && ! true/}
		\item \java{true || false && true} 
		\item \java{false && (true || false)} 
		\item \Colorbox{listingback}{\verb/!(true || false) && true/}
	\end{itemize} 
\end{frame}



%%%
%\subsection{Les expressions relationnelles}

\begin{frame}[fragile]{Les expressions relationnelles}
	\emph{Opérateurs de comparaison}
	\begin{center}
		\Large
		\java{<}\quad \java{>}\quad \java{<=}\quad \java{>=}
	\end{center}
	\medskip
	\begin{itemize}
		\item Opérandes de type \emph{numériques}
		\item Le \emph{résultat} est du type \emph{boolean}
	\end{itemize}
\end{frame}

\begin{frame}[fragile]{Les expressions relationnelles}
	\emph{Opérateurs d'égalité}
	\begin{center}
		\Large
		\java{==}\quad \Colorbox{listingback}{\verb|!=|}
	\end{center}
	\medskip
	\begin{itemize}
		\item Opérandes de \emph{tout type}
		\item Sens différent si type primitif ou référence
	\end{itemize}
\end{frame}


\begin{frame}[fragile]{Égalité de valeurs}
	\textbf{Type primitif}
	\\Les \emph{valeurs} sont comparées
	\begin{center}
	\includegraphics[scale=.5]{../img/java-logi-egal1} 
	\end{center}
	\bigskip
	On a : \java{a==c} mais \Colorbox{listingback}{\verb|a!=b|} et \Colorbox{listingback}{\verb|b!=c|}
\end{frame}

\begin{frame}[fragile]{Égalité de valeurs}
	\textbf{Type référence}
	\\Les \emph{références} sont comparées
	\begin{center}
	\includegraphics[scale=.5]{../img/java-logi-egal2} 
	\end{center}
	\bigskip
	On a : \Colorbox{listingback}{\verb|a!=b|}, \Colorbox{listingback}{\verb|a!=c|} mais \java{a==d}
\end{frame}

\full[bluepigment]{
	\color{azuremist}
	\par\textbf{Cas particulier du type \texttt{\bf String}}
	\par\medskip
	Le compilateur réutilise l'espace pour les \emph{littéraux} 
	de type \texttt{String}
	\bigskip
	{\tt\small
	\\String s1 = "Hello";
    \\String s2 = "Hello";
  	\\String s3 = "Hel";
  	\\s3 = s3 + "lo";
	\\System.out.println(s1==s2); // Vrai
	\\System.out.println(s1==s3); // Faux
  	\\s2 = "Bye";
	\\System.out.println(s1==s2); // Faux
	}
}


\begin{frame}[fragile]{Egalité de valeur}
	\textbf{equals()}
	\medskip
\begin{Java}
{
  String s1 = "Hello";
  String s2 = "Hello";
  String s3 = "Hel";
  s3 = s3 + "lo";
  System.out.println(s1.equals(s2)); // Vrai
  System.out.println(s1.equals(s3)); // Vrai
}
\end{Java}
	\begin{itemize}
		\item Ne teste pas que les références sont identiques
		\item Mais bien que les \emph{valeurs} référencées sont égales
	\end{itemize}
\end{frame}

%%%
%\subsection{Les expressions conditionnelles}

\begin{frame}[fragile]{L'expression conditionnelle}
	\emph{Opérateur conditionnel}
	\begin{center}
		\huge
		\Colorbox{listingback}{\verb|?:|} 
	\end{center}
	\begin{itemize}
		\item Équivalent du \emph{si-sinon} sous forme d'expression
		\item {\tt <condition> ? <expression> : <expression>}
	\end{itemize}
	\medskip
	\emph{Exemples}
	\begin{itemize}
	\item \Colorbox{listingback}{\verb|heure < 12 ? "bonjour" : "bonsoir"|}
	\item  
	\begin{Java}
int n = -4; 
int abs = n > 0 ? n : -n;
	\end{Java}
	\end{itemize}
\end{frame}

\begin{frame}[fragile]{Tableau des priorités et associativités}
	\textbf{Tableau des priorités \#3}
\begin{small}
\begin{center}
\begin{tabular}{r|c|c}
 priorité & opérateur & associativité \\ \hline
grande & \java{-}, \java{+} unaires, \Colorbox{listingback}{\verb|!|} & $\Longleftarrow$ \\
 & \java{*}, \java{/}, \java{\%} & $\Longrightarrow$ \\
 & \java{-}, \java{+} binaires & $\Longrightarrow$ \\
 & \java{<}, \java{>}, \java{<=}, \java{>=} & $\Longrightarrow$ \\
 & \java{==}, \Colorbox{listingback}{\verb|!=|} & $\Longrightarrow$ \\
 & \java{&&} & $\Longrightarrow$ \\
 & \java{||} & $\Longrightarrow$ \\
faible & \Colorbox{listingback}{\verb|?:|} & $\Longleftarrow$ \\
\end{tabular}
\end{center}
\end{small}
\end{frame}


%%%
%\subsection{Un mot sur les conversions}

\imgfullh{../img/Trick_of_Nature-croped.jpg}{
	\begin{center}
	\Large\bf\color{white}
	\vspace{16mm}
	Peut-on mélanger les types ?
	\end{center}
}{http://moscowbeast.deviantart.com/art/Tricky-Nature-24390118}

\note{
	\par 
	Peut-on mélanger les types ?
	\begin{itemize}
		\item Normalement pas
		\item Accepté si pas de perte d'information
		\item \emph{Conversion} effectuée \emph{automatiquement} par le compilateur
		\item Une leçon entière sera consacrée à ce sujet
	\end{itemize}
}

\begin{frame}[fragile]{Un mot sur les conversions}
	\emph{Exemples}
	\begin{itemize}
		\item Calcul mélangeant les entiers et les réels
	  	\begin{itemize}
  			\item Les entiers sont convertis en réels
  			\item \emph{Ex} : \java{3.2/2} vaut $1.6$ de type \java{double}
  		\end{itemize}
		\item Assigner un entier à un réel
  		\begin{itemize}
  			\item L'entier est converti en réel
  			\item \emph{Ex} : \java{double d = 1; // d vaut 1.0}
  		\end{itemize}
		\item Assigner un réel à un entier
  		\begin{itemize}
  			\item Refusé \dots\ sauf si demandé explicitement (\emph{casting})
  			\item \emph{Ex} : \java{int i = 1.2; // refusé}
  			\item \emph{Ex} : \java{int j = (int) 1.6; // j vaut 1}
  		\end{itemize}
	\end{itemize}
\end{frame}
